タグのパースの工程を詳細に仕様化する。
一応完成したがパーサーの実装を意識した書き方にできないか。
省略形、codeの考慮がない。
とりあえず完成させてからOrenoで本格的な仕様書を作る。

初期状態
    ':'でなければ不適合。
    タグ名読み込み中に遷移。

タグ名読み込み中
    '['だったら
        属性読み込み開始に遷移。
    '{'だったら
        内容読み込み開始に遷移。
    タグ名に使えない文字
        "There is an illegal character. '{}'", c
    空白、改行、ブロック終了(EOF)
        パース終了。
    タグ名に使える文字
        バッファに追加。

属性読み込み開始
    '['である
        インデントチェックを無効にする。
        新規属性待ちに遷移。
    '['ではない
        内容読み込み開始に遷移。

新規属性待ち
    ']'だったら
        内容読み込み開始に遷移。
    '"'だったら
        引用符付き属性値読み込み中に遷移。
    空白、改行
        スキップ。
    ブロック開始、ブロック終了
        エラー。インデントチェック無効なので発生しないはず。
    それ以外の文字だったら
        属性名読み込み中に遷移。
    EOFだったら
        "'{}' is required.", "]"
    
属性名読み込み中
    英数字かハイフンだったら
        バッファに追加。
    '='だったら
        属性名あり
            属性値読み込み開始に遷移。
        属性名なし
            "There is an illegal character. {}", "="
    空白、改行、']'だったら
        属性名あり
            属性名を無名属性値と見なす。属性値読み込み終了に遷移。
        属性名なし
            あり得ない。前に他の文字がなければこのモードにならない。
    属性名に使えない文字
        最初にリセットして単純属性値読み込み中に遷移。
    EOFだったら
        "Unexpected end of attribute name."
    ブロック開始、ブロック終了
        インデントチェック無効なのでありえない。

属性値読み込み開始
    属性値を今から読み込む。あるのかないのか、引用符の有無も分からない。

    '"'だったら
        引用符付き属性値読み込み中に遷移。
    空白、改行、']'だったら
        属性値は空。
        属性値読み込み終了に遷移。
    EOFだったら
        "Unexpected end of attribute value."
    それ以外の文字だったら
        単純属性値読み込み中に遷移。
    ブロック開始、ブロック終了
        インデントチェック無効なのでありえない。

単純属性値読み込み中
    '"'だったら
        "There is an illegal character. {}", c
    空白、改行、']'だったら
        属性値読み込み終了に遷移。
    EOFだったら
        "Unexpected end of attribute value."
    それ以外の文字だったら
        バッファに追加。
    ブロック開始、ブロック終了
        インデントチェック無効なのでありえない。

引用符付き属性値読み込み中
    '"'だったら
        引用符出現に遷移。
    他の文字
        バッファに追加する。
    改行、EOF
        "Unexpected end of attribute value."
    ブロック開始、ブロック終了
        インデントチェック無効なのでありえない。

引用符出現
    引用符付き属性値の中に1つの引用符が出現した。

    '"'だったら
        引用符をバッファに追加。
        引用符付き属性値読み込み中に遷移する。
    それ以外
        属性値読み込み終了に遷移する。

属性値読み込み終了
    空白か属性の終了を待っている状態。

    空白、改行だったら
        新規属性待ちに遷移。
    ']'だったら
        内容読み込み開始に遷移。
    それ以外の文字だったら
        "There is an illegal character. {}", c
    EOFだったら
        "'{}' is required.", "]"
    ブロック開始、ブロック終了
        インデントチェック無効なのでありえない。

内容読み込み開始
    '{'だったら
        インデントチェックを無効にする。
        内容読み込み中に遷移。
    '{'でなければ
        内容なしで終了。

内容読み込み中
    '}'だったら
        パース終了。
    改行、それ以外の文字だったら
        インライン要素としてパース。
    EOFだったら
        "'}' is required."
    ブロック開始、ブロック終了
        インデントチェック無効なのでありえない。
